[tasks.dev]
description = "Start dev mode with hot reload"
run = "node esbuild.config.mjs"

[tasks.build]
description = "Build for distribution"
run = "node esbuild.config.mjs production"

[tasks.test]
description = "Run tests"
run = "echo 'There are no tests. This is intended.'"

[tasks.quality]
description = "All quality checks (lint + format + type-check)"
depends = ["lint", "format", "type-check"]

[tasks.lint]
description = "ESLint only"
run = "npx eslint src"

[tasks.format]
description = "Prettier check"
run = "npx prettier --check src"

[tasks.type-check]
description = "TypeScript type checking"
run = "npx tsc --noEmit"

[tasks.deploy]
description = "Build and copy to Obsidian plugins folder"
depends = ["build"]
run = """
PLUGIN_DIR="${OBSIDIAN_PLUGIN_DIR:-$HOME/Documents/Obsidian/the void/.obsidian/plugins/smarthole-client}"
mkdir -p "$PLUGIN_DIR"
cp dist/main.js manifest.json src/styles.css "$PLUGIN_DIR/"
echo "Deployed to: $PLUGIN_DIR"
"""
